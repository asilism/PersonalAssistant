<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Assistant - Orchestration Service</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Personal Assistant - Orchestration Service</h1>
            <p class="subtitle">LangGraph-based orchestration with MCP agent integration</p>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('manual')">ğŸ“ Manual Request</div>
            <div class="tab" onclick="switchTab('settings')">âš™ï¸ LLM Settings</div>
            <!-- MCP Server tab hidden - using predefined servers -->
            <div class="tab" onclick="switchTab('mcp')" style="display: none;">ğŸ”Œ MCP Servers</div>
        </div>

        <!-- Chat Tab -->
        <div id="manual-tab" class="tab-content active">
            <div class="split-container">
                <!-- Left: Chat Section -->
                <div class="chat-container">
                    <!-- Chat Messages Area -->
                    <div class="chat-messages" id="chatMessages">
                        <div class="welcome-message">
                            <p>ğŸ‘‹ Welcome to Personal Assistant!</p>
                            <p style="font-size: 14px; color: #666;">Start chatting or try one of the quick examples below</p>
                        </div>
                    </div>

                    <!-- Simple Query Examples -->
                    <div class="example-category" style="margin-top: 10px; padding: 10px; background: #f0f7ff; border-radius: 8px; border-left: 4px solid #4CAF50;">
                        <div class="category-header" onclick="toggleCategory('simple-examples')" style="font-size: 13px; font-weight: 600; color: #2E7D32; margin-bottom: 8px; cursor: pointer; user-select: none; display: flex; justify-content: space-between; align-items: center;">
                            <span>âœ¨ ë‹¨ìˆœ ì§ˆë¬¸ ì˜ˆì œ</span>
                            <span class="toggle-icon" id="simple-examples-icon">â–¼</span>
                        </div>
                        <div class="chat-examples" id="simple-examples" style="display: flex;">
                            <button class="example-btn" onclick="setExample('Send an email to john@example.com about the meeting tomorrow')" title="Send an email to john@example.com about the meeting tomorrow">ğŸ“§ Send Email</button>
                            <button class="example-btn" onclick="setExample('Create a calendar event for team meeting on Friday at 2 PM')" title="Create a calendar event for team meeting on Friday at 2 PM">ğŸ“… Create Event</button>
                            <button class="example-btn" onclick="setExample('Search for issues assigned to me in Jira')" title="Search for issues assigned to me in Jira">ğŸ« Search Jira</button>
                            <button class="example-btn" onclick="setExample('Calculate 25 * 8 + 150')" title="Calculate 25 * 8 + 150">ğŸ”¢ Calculate</button>
                            <button class="example-btn" onclick="setExample('Search for latest AI news and write a brief report')" title="Search for latest AI news and write a brief report">ğŸ“° RPA: News Report</button>
                        </div>
                    </div>

                    <!-- Complex Multi-Tool Examples -->
                    <div class="example-category" style="margin-top: 10px; padding: 10px; background: #f0f7ff; border-radius: 8px; border-left: 4px solid #2196F3;">
                        <div class="category-header" onclick="toggleCategory('complex-examples')" style="font-size: 13px; font-weight: 600; color: #1976D2; margin-bottom: 8px; cursor: pointer; user-select: none; display: flex; justify-content: space-between; align-items: center;">
                            <span>ğŸ”§ ë³µí•© ì§ˆë¬¸ ì˜ˆì œ</span>
                            <span class="toggle-icon" id="complex-examples-icon">â–¼</span>
                        </div>
                        <div class="chat-examples" id="complex-examples" style="display: flex;">
                            <button class="example-btn" onclick="setExample('Project Reviewì˜ ì¼ì •ì˜ end dateë¥¼ 11ì›” 30ì¼ë¡œ ë³€ê²½í•´ì¤˜. ê·¸ë¦¬ê³  ì°¸ì„ìë“¤ì—ê²Œ ì¼ì •ì´ ë³€ê²½ë˜ì—ˆë‹¤ê³  ë©”ì¼ë¡œ ì•Œë ¤ì¤˜')" title="Project Reviewì˜ ì¼ì •ì˜ end dateë¥¼ 11ì›” 30ì¼ë¡œ ë³€ê²½í•´ì¤˜. ê·¸ë¦¬ê³  ì°¸ì„ìë“¤ì—ê²Œ ì¼ì •ì´ ë³€ê²½ë˜ì—ˆë‹¤ê³  ë©”ì¼ë¡œ ì•Œë ¤ì¤˜" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">ğŸ“…âœ‰ï¸ ì¼ì • ë³€ê²½ + ì´ë©”ì¼ ì•Œë¦¼</button>
                            <button class="example-btn" onclick="setExample('ì´ë²ˆ ì£¼ ì›”ìš”ì¼ë¶€í„° ê¸ˆìš”ì¼ê¹Œì§€ ëª¨ë“  íšŒì˜ ì¼ì •ì„ ì¡°íšŒí•˜ê³ , ê° íšŒì˜ë³„ë¡œ Jiraì—ì„œ ê´€ë ¨ëœ ì´ìŠˆë“¤ì„ ì°¾ì•„ì„œ íšŒì˜ ì¤€ë¹„ ìë£Œë¥¼ ì´ë©”ì¼ë¡œ ë³´ë‚´ì¤˜')" title="ì´ë²ˆ ì£¼ ì›”ìš”ì¼ë¶€í„° ê¸ˆìš”ì¼ê¹Œì§€ ëª¨ë“  íšŒì˜ ì¼ì •ì„ ì¡°íšŒí•˜ê³ , ê° íšŒì˜ë³„ë¡œ Jiraì—ì„œ ê´€ë ¨ëœ ì´ìŠˆë“¤ì„ ì°¾ì•„ì„œ íšŒì˜ ì¤€ë¹„ ìë£Œë¥¼ ì´ë©”ì¼ë¡œ ë³´ë‚´ì¤˜" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">ğŸ“…ğŸ«âœ‰ï¸ ì£¼ê°„ íšŒì˜ ì¤€ë¹„</button>
                            <button class="example-btn" onclick="setExample('ë‚´ì¼ ì˜¤ì „ 10ì‹œì— ì¼ì •ì´ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ë¹„ì–´ìˆìœ¼ë©´ Team Sync ë¯¸íŒ…ì„ ì¶”ê°€í•œ ë‹¤ìŒ íŒ€ì›ë“¤ì—ê²Œ ì´ˆëŒ€ ë©”ì¼ì„ ë°œì†¡í•´ì¤˜')" title="ë‚´ì¼ ì˜¤ì „ 10ì‹œì— ì¼ì •ì´ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ë¹„ì–´ìˆìœ¼ë©´ Team Sync ë¯¸íŒ…ì„ ì¶”ê°€í•œ ë‹¤ìŒ íŒ€ì›ë“¤ì—ê²Œ ì´ˆëŒ€ ë©”ì¼ì„ ë°œì†¡í•´ì¤˜" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">ğŸ”ğŸ“…âœ‰ï¸ ì¼ì • í™•ì¸ + ë¯¸íŒ… ìƒì„±</button>
                            <button class="example-btn" onclick="setExample('ë‹¤ìŒ ì£¼ ì „ì²´ ìº˜ë¦°ë”ë¥¼ í™•ì¸í•´ì„œ 3ì‹œê°„ ì´ìƒ ì—°ì†ëœ íšŒì˜ê°€ ìˆëŠ”ì§€ ì°¾ê³ , ìˆë‹¤ë©´ ì¼ì • ì¡°ì •ì´ í•„ìš”í•˜ë‹¤ê³  ê´€ë ¨ ì°¸ì„ìë“¤ì—ê²Œ ì´ë©”ì¼ì„ ë³´ë‚´ì¤˜')" title="ë‹¤ìŒ ì£¼ ì „ì²´ ìº˜ë¦°ë”ë¥¼ í™•ì¸í•´ì„œ 3ì‹œê°„ ì´ìƒ ì—°ì†ëœ íšŒì˜ê°€ ìˆëŠ”ì§€ ì°¾ê³ , ìˆë‹¤ë©´ ì¼ì • ì¡°ì •ì´ í•„ìš”í•˜ë‹¤ê³  ê´€ë ¨ ì°¸ì„ìë“¤ì—ê²Œ ì´ë©”ì¼ì„ ë³´ë‚´ì¤˜" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: white;">ğŸ“ŠğŸ“…âœ‰ï¸ ì¼ì • ì¶©ëŒ ê°ì§€</button>
                            <button class="example-btn" onclick="setExample('ì§€ë‚œì£¼ì— ì™„ë£Œëœ Jira ì´ìŠˆë“¤(status=Done)ì„ ì¡°íšŒí•˜ê³ , ê° ì´ìŠˆì˜ ì œëª©, ë‹´ë‹¹ì, ì™„ë£Œì¼ì„ í¬í•¨í•œ ìš”ì•½ ë³´ê³ ì„œë¥¼ sungjun87.lee@samsung.comì—ê²Œ ì´ë©”ì¼ë¡œ ì „ì†¡í•´ì¤˜')" title="ì§€ë‚œì£¼ì— ì™„ë£Œëœ Jira ì´ìŠˆë“¤(status=Done)ì„ ì¡°íšŒí•˜ê³ , ê° ì´ìŠˆì˜ ì œëª©, ë‹´ë‹¹ì, ì™„ë£Œì¼ì„ í¬í•¨í•œ ìš”ì•½ ë³´ê³ ì„œë¥¼ sungjun87.lee@samsung.comì—ê²Œ ì´ë©”ì¼ë¡œ ì „ì†¡í•´ì¤˜" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: white;">ğŸ«ğŸ“„âœ‰ï¸ ì£¼ê°„ ë³´ê³ ì„œ ìë™í™”</button>
                        </div>
                    </div>

                    <!-- Chat Input Area -->
                    <div class="chat-input-container">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <div style="font-size: 12px; color: #999;">ì§ˆë¬¸ì„ ì…ë ¥í•˜ê±°ë‚˜ ìœ„ì˜ ì˜ˆì œ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</div>
                            <button class="clear-chat-btn" onclick="clearChatHistory()" title="ëŒ€í™” ì´ë ¥ì„ ì‚­ì œí•©ë‹ˆë‹¤">
                                ğŸ—‘ï¸ Clear Chat
                            </button>
                        </div>
                        <form id="requestForm" class="chat-input-form">
                            <input type="hidden" id="userId" value="test_user">
                            <input type="hidden" id="tenant" value="test_tenant">
                            <textarea id="requestText" class="chat-input" placeholder="Type your message here..." required rows="1"></textarea>
                            <button type="submit" id="submitBtn" class="chat-send-btn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span style="margin-left: 6px;">ì „ì†¡</span>
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Right: Logs Section -->
                <div class="logs-panel" id="logsPanel">
                    <div class="logs-header">
                        <span>ğŸ“‹ Execution Logs</span>
                    </div>
                    <div class="logs-content" id="logsContent">
                        <p style="color: #999; text-align: center; padding: 20px;">No logs yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings-tab" class="tab-content">
            <div class="settings-container">
                <h2>âš™ï¸ LLM Settings</h2>
                <p style="color: #666; margin-bottom: 20px;">Configure your LLM provider and API credentials</p>

                <div class="settings-card">
                    <div class="form-group">
                        <label for="llmProvider">LLM Provider</label>
                        <select id="llmProvider" onchange="updateModelOptions()">
                            <option value="anthropic">Anthropic Claude</option>
                            <option value="openai">OpenAI GPT</option>
                            <option value="openrouter">OpenRouter</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="apiKey">API Key</label>
                        <input type="password" id="apiKey" placeholder="Enter your API key">
                        <small style="color: #666;">Your API key is encrypted and stored securely</small>
                    </div>

                    <div class="form-group">
                        <label for="baseUrl">Base URL (Optional)</label>
                        <input type="text" id="baseUrl" placeholder="Leave empty for default">
                        <small style="color: #666;">Override the default API endpoint URL</small>
                    </div>

                    <div class="form-group">
                        <label for="llmModel">Model</label>
                        <select id="llmModel">
                            <!-- Options will be populated based on provider -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="maxRetries">Max Retries</label>
                        <input type="number" id="maxRetries" value="3" min="1" max="10">
                        <small style="color: #666;">Maximum number of retry attempts</small>
                    </div>

                    <div class="form-group">
                        <label for="timeout">Timeout (ms)</label>
                        <input type="number" id="timeout" value="30000" min="5000" step="1000">
                        <small style="color: #666;">Request timeout in milliseconds</small>
                    </div>

                    <div class="settings-actions">
                        <button onclick="testConnection()" id="testBtn">ğŸ§ª Test Connection</button>
                        <button onclick="saveSettings()" id="saveBtn">ğŸ’¾ Save Settings</button>
                    </div>

                    <div id="settingsResult" class="settings-result">
                        <!-- Result messages will appear here -->
                    </div>
                </div>

                <div class="current-settings-card">
                    <h3>Current Settings</h3>
                    <div id="currentSettings">
                        <div class="loading">Loading...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MCP Servers Tab -->
        <div id="mcp-tab" class="tab-content">
            <div class="settings-container">
                <h2>ğŸ”Œ MCP Server Settings</h2>
                <p style="color: #666; margin-bottom: 20px;">Configure your MCP servers</p>

                <div class="settings-card">
                    <h3>Add/Update MCP Server</h3>

                    <div class="form-group">
                        <label for="mcpServerName">Server Name</label>
                        <input type="text" id="mcpServerName" placeholder="e.g., mail_agent">
                    </div>

                    <div class="form-group">
                        <label for="mcpEnabled">Enabled</label>
                        <select id="mcpEnabled">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="mcpTransport">Transport Type</label>
                        <select id="mcpTransport" onchange="updateMCPTransportFields()">
                            <option value="http">HTTP (URL-based)</option>
                            <option value="stdio">STDIO (Command-based)</option>
                        </select>
                        <small style="color: #666;">Choose how to connect to the MCP server</small>
                    </div>

                    <div class="form-group" id="mcpUrlGroup">
                        <label for="mcpUrl">Server URL</label>
                        <input type="text" id="mcpUrl" placeholder="http://localhost:8001">
                        <small style="color: #666;">URL endpoint for the MCP server</small>
                    </div>

                    <div class="form-group" id="mcpCommandGroup" style="display: none;">
                        <label for="mcpCommand">Command</label>
                        <input type="text" id="mcpCommand" value="fastmcp" placeholder="fastmcp">
                        <small style="color: #666;">Command to execute (usually 'fastmcp')</small>
                    </div>

                    <div class="form-group" id="mcpArgsGroup" style="display: none;">
                        <label for="mcpArgs">Arguments (JSON Array)</label>
                        <textarea id="mcpArgs" placeholder='["run", "path/to/server.py"]' rows="3"></textarea>
                        <small style="color: #666;">Arguments as JSON array</small>
                    </div>

                    <div class="form-group">
                        <label for="mcpEnvVars">Environment Variables (JSON Object)</label>
                        <textarea id="mcpEnvVars" placeholder='{"KEY": "value"}' rows="3"></textarea>
                        <small style="color: #666;">Environment variables as JSON object (optional)</small>
                    </div>

                    <div class="settings-actions">
                        <button onclick="saveMCPServer()" id="saveMCPBtn">ğŸ’¾ Save MCP Server</button>
                    </div>

                    <div id="mcpResult" class="settings-result">
                        <!-- Result messages will appear here -->
                    </div>
                </div>

                <div class="current-settings-card">
                    <h3>Current MCP Servers</h3>
                    <div id="currentMCPServers">
                        <div class="loading">Loading...</div>
                    </div>
                </div>

                <div class="current-settings-card">
                    <h3>Available MCP Tools</h3>
                    <p style="color: #666; margin-bottom: 15px;">View all tools discovered from your MCP servers</p>
                    <div class="settings-actions">
                        <button onclick="loadMCPTools()" id="loadToolsBtn">ğŸ”§ Load Available Tools</button>
                    </div>
                    <div id="mcpToolsList">
                        <p style="color: #999; text-align: center; padding: 20px;">Click "Load Available Tools" to see what tools are registered</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
